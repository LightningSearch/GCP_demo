<!DOCTYPE html>
<html>
<title>
GitHub - NVIDIA/Megatron-LM: Ongoing research training transformer language models at scale, including: BERT &amp; GPT-2 
</title>

<body style="font-family:Verdana,Arial,Helvetica,sans-serif;font-size:0.9em">
<h2>
Body text
</h2>
<p>
tag before the DOM renders --> Skip to content Sign&nbsp;up Sign&nbsp;up Why GitHub? Features &rarr; Mobile &rarr; Actions &rarr; Codespaces &rarr; Packages &rarr; Security &rarr; Code review &rarr; Project management &rarr; Integrations &rarr; GitHub Sponsors &rarr; Customer stories &rarr; Team Enterprise Explore Explore GitHub &rarr; Learn and contribute Topics &rarr; Collections &rarr; Trending &rarr; Learning Lab &rarr; Open source guides &rarr; Connect with others The ReadME Project &rarr; Events &rarr; Community forum &rarr; GitHub Education &rarr; GitHub Stars program &rarr; Marketplace Pricing Plans &rarr; Compare plans &rarr; Contact Sales &rarr; Education &rarr; --> In this repository All GitHub ↵ Jump to ↵ No suggested jump to results In this repository All GitHub ↵ Jump to ↵ In this organization All GitHub ↵ Jump to ↵ In this repository All GitHub ↵ Jump to ↵ Sign in Sign up Sign up {{ message }} <include-fragment class="js-notification-shelf-include-fragment" data-base-src="https://github.com/notifications/beta/shelf"> NVIDIA / Megatron-LM Notifications Star 1.8k Fork 347 Ongoing research training transformer language models at scale, including: BERT &amp; GPT-2 View license 1.8k stars 347 forks Star Notifications Code Issues 47 Pull requests 8 Actions Security <include-fragment src="/NVIDIA/Megatron-LM/security/overall-count" accept="text/fragment+html"> Insights More <details-menu role="menu" class="dropdown-menu dropdown-menu-sw "> Code Issues Pull requests Actions Security Insights main Switch branches/tags <input-demux data-action="tab-container-change:input-demux#storeInput tab-container-changed:input-demux#updateInput"> <tab-container class="d-flex flex-column js-branches-tags-tabs" style="min-height: 0;"> Branches Tags <ref-selector type="branch" data-targets="input-demux.sinks" data-action=" input-entered:ref-selector#inputEntered tab-selected:ref-selector#tabSelected focus-list:ref-selector#focusFirstListMember " query-endpoint="/NVIDIA/Megatron-LM/refs" cache-key="v0:1616442877.9639602" current-committish="bWFpbg==" default-branch="bWFpbg==" name-with-owner="TlZJRElBL01lZ2F0cm9uLUxN" > Nothing to show {{ refName }} default View all branches <ref-selector type="tag" data-action=" input-entered:ref-selector#inputEntered tab-selected:ref-selector#tabSelected focus-list:ref-selector#focusFirstListMember " data-targets="input-demux.sinks" query-endpoint="/NVIDIA/Megatron-LM/refs" cache-key="v0:1616442877.9639602" current-committish="bWFpbg==" default-branch="bWFpbg==" name-with-owner="TlZJRElBL01lZ2F0cm9uLUxN" > Nothing to show {{ refName }} default View all tags 2 branches 7 tags Go to file <get-repo > Code Clone <tab-container > --> HTTPS GitHub CLI <clipboard-copy value="https://github.com/NVIDIA/Megatron-LM.git" aria-label="Copy to clipboard" class="btn btn-sm" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;COPY_URL&quot;,&quot;git_repository_type&quot;:&quot;REPOSITORY&quot;,&quot;repository_id&quot;:176982014,&quot;originating_url&quot;:&quot;https://github.com/NVIDIA/Megatron-LM&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="e508eb3fbb400f4a4b9390501b6088df4cbe9854db3f4e30cd7db327edd03832"> Use Git or checkout with SVN using the web URL. <clipboard-copy value="gh repo clone NVIDIA/Megatron-LM" aria-label="Copy to clipboard" class="btn btn-sm" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;COPY_URL&quot;,&quot;git_repository_type&quot;:&quot;REPOSITORY&quot;,&quot;repository_id&quot;:176982014,&quot;originating_url&quot;:&quot;https://github.com/NVIDIA/Megatron-LM&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="e508eb3fbb400f4a4b9390501b6088df4cbe9854db3f4e30cd7db327edd03832"> Work fast with our official CLI. Learn more . Open with GitHub Desktop Download ZIP Launching GitHub Desktop If nothing happens, download GitHub Desktop and try again. Go back Launching GitHub Desktop If nothing happens, download GitHub Desktop and try again. Go back Launching Xcode If nothing happens, download Xcode and try again. Go back Launching Visual Studio If nothing happens, download the GitHub extension for Visual Studio and try again. Go back Latest commit jaredcasper Cherry-pick fix from development repo. &hellip; <include-fragment accept="text/fragment+html" src="/NVIDIA/Megatron-LM/commit/8aa4619f2b2a57b5725026a50ebd2b15e8121482/rollup?direction=sw" class="d-inline"> 8aa4619 <relative-time datetime="2021-03-22T19:54:02Z" class="no-wrap">Mar 23, 2021 Cherry-pick fix from development repo. 8aa4619 Git stats 656 commits Files Permalink Failed to load latest commit information. Type Name Latest commit message Commit time examples Readme update + change gpt2 to gpt <time-ago datetime="2021-01-12T01:18:43Z" class="no-wrap ">Jan 12, 2021 images Readme update + change gpt2 to gpt <time-ago datetime="2021-01-12T01:18:43Z" class="no-wrap ">Jan 12, 2021 megatron Cherry-pick fix from development repo. <time-ago datetime="2021-03-22T19:54:02Z" class="no-wrap ">Mar 22, 2021 tasks Use new api to get loss scale when finetuning. <time-ago datetime="2021-01-05T19:53:51Z" class="no-wrap ">Jan 5, 2021 tools Readme update + change gpt2 to gpt <time-ago datetime="2021-01-12T01:18:43Z" class="no-wrap ">Jan 12, 2021 .gitignore pip support added <time-ago datetime="2020-05-14T20:20:50Z" class="no-wrap ">May 14, 2020 LICENSE make minor modifications to licnese wording <time-ago datetime="2020-04-16T20:33:14Z" class="no-wrap ">Apr 16, 2020 MANIFEST.in helpers.cpp suupport added, version changed, clean up <time-ago datetime="2020-05-14T20:20:50Z" class="no-wrap ">May 14, 2020 README.md TOC fix <time-ago datetime="2021-01-12T21:36:43Z" class="no-wrap ">Jan 12, 2021 pretrain_bert.py Fix TensorBoard writes <time-ago datetime="2020-12-19T05:47:12Z" class="no-wrap ">Dec 19, 2020 pretrain_gpt.py Readme update + change gpt2 to gpt <time-ago datetime="2021-01-12T01:18:43Z" class="no-wrap ">Jan 12, 2021 pretrain_ict.py Fix TensorBoard writes <time-ago datetime="2020-12-19T05:47:12Z" class="no-wrap ">Dec 19, 2020 requirements.txt update2 <time-ago datetime="2020-05-14T20:32:23Z" class="no-wrap ">May 14, 2020 setup.py update <time-ago datetime="2020-05-15T00:00:17Z" class="no-wrap ">May 15, 2020 View code README.md Megatron is a large, powerful transformer developed by the Applied Deep Learning Research team at NVIDIA. This repository is for ongoing research on training large transformer language models at scale. We developed efficient, model-parallel (tensor and pipeline), and multi-node pre-training of GPT and BERT using mixed precision. Below are some of the projects where we have directly used Megatron: BERT and GPT Studies Using Megatron BioMegatron: Larger Biomedical Domain Language Model End-to-End Training of Neural Retrievers for Open-Domain Question Answering Large Scale Multi-Actor Generative Dialog Modeling Local Knowledge Powered Conversational Agents MEGATRON-CNTRL: Controllable Story Generation with External Knowledge Using Large-Scale Language Models RACE Reading Comprehension Dataset Leaderboard Training Question Answering Models From Synthetic Data Our codebase is capable of efficiently training very large (hundreds of billions of parameters) language models with both model and data parallelism. To demonstrate how the code scales with multiple GPUs and model sizes, we consider GPT models from 1 billion all the way to 1 trillion parameters. All models use a vocabulary size of 51,200 and a sequence length of 2048. We vary hidden size, number of attention heads, and number of layers to arrive at a specifc model size. As the model size increases, we also modestly increase the batch size. We leverage NVIDIA's Selene supercomputer to perform scaling studies and use up to 3072 A100 GPUs for the largest model. The table below shows the model configurations along with the achieved FLOPs per second (both per GPU and aggregate over all GPUs). Note that the FLOPs are measured for end-to-end training, i.e., includes all operations including data loading, optimization, and even logging. The following figures show achieved percentage of theoretical peak FLOPs and achieved aggregate petaFLOPs per second as a function of number of GPUs. All the cases from 1 billion to 1 trillion achieve more than 41% half precision utilization, which is high for an end-to-end application. We observe that initially as the model parallel size increases, utilization slightly decreases; as hidden size increases for larger models, utilization starts increasing and reaches 49% for the largest model. We also note that achieved aggregate petaFLOPs per second across all GPUs increases almost linearly with number of GPUs, demonstrating good weak scaling. Contents Contents Setup Downloading Checkpoints Usage Training Data Preprocessing BERT Pretraining GPT Pretraining Distributed BERT or GPT Pretraining GPT-3 Example Evaluation and Tasks GPT Text Generation GPT Evaluation WikiText Perplexity Evaluation LAMBADA Cloze Accuracy BERT Task Evaluation RACE Evaluation MNLI Evaluation Datasets Collecting Wikipedia Training Data Collecting GPT Webtext Data Setup We have tested Megatron with NGC's PyTorch container version 20.12, which uses python 3.8, pytorch 1.8, cuda 11.1, and nccl 2.8.3. To use this repository, please install the latest supported versions of PyTorch with GPU support (python 3.8, pytorch 1.8, cuda 11.1, and nccl 2.8.3 and above) and NVIDIA APEX . We strongly recommend using one of NGC's recent PyTorch containers (the latest compatible version at time of publication can be pulled with docker pull nvcr.io/nvidia/pytorch:20.12-py3 ). Data preprocessing requires NLTK , though this is not required for training, evaluation, or downstream tasks. Downloading Checkpoints We have provided pretrained BERT-345M and GPT-345M checkpoints for use to evaluate or finetuning downstream tasks. To access these checkpoints, first sign up for and setup the NVIDIA GPU Cloud (NGC) Registry CLI. Further documentation for downloading models can be found in the NGC documentation . Alternatively, you can directly download the checkpoints using: BERT-345M-uncased: wget --content-disposition https://api.ngc.nvidia.com/v2/models/nvidia/megatron_bert_345m/versions/v0.1_cased/zip -O megatron_bert_345m_v0.1_uncased.zip BERT-345M-cased: wget --content-disposition https://api.ngc.nvidia.com/v2/models/nvidia/megatron_bert_345m/versions/v0.1_cased/zip -O megatron_bert_345m_v0.1_cased.zip GPT-345M: wget --content-disposition https://api.ngc.nvidia.com/v2/models/nvidia/megatron_lm_345m/versions/v0.0/zip -O megatron_lm_345m_v0.0.zip The models require vocabulary files to run. The BERT WordPiece vocab file can be extracted from Google's pretrained BERT models: uncased , cased . The GPT vocab file and merge table can be downloaded directly. Usage After installation, there are several possible workflows. The most comprehensive is: Data preprocessing Pretraining Finetuning (Optional for zero-shot tasks) Downstream task evaluation or text generation However, steps 1 and 2 can be replaced by using one of the pretrained models mentioned above. We've provided several scripts for pretraining both BERT and GPT in examples directory, as well as scripts for both zero-shot and fine-tuned downstream tasks including MNLI, RACE, WikiText103, and LAMBADA evaluation. There is also a script for GPT interactive text generation. Training Data Preprocessing The training data requires preprocessing. First, place your training data in a loose json format, with one json containing a text sample per line. For example: {"src": "www.nvidia.com", "text": "The quick brown fox", "type": "Eng", "id": "0", "title": "First Part"} {"src": "The Internet", "text": "jumps over the lazy dog", "type": "Eng", "id": "42", "title": "Second Part"} The name of the text field of the json can be changed by using the --json-key flag in preprocess_data.py The other metadata are optional and are not used in training. The loose json is then processed into a binary format for training. To convert the json into mmap, cached index file, or the lazy loader format use preprocess_data.py . Set the --dataset-impl flag to mmap , cached , or lazy , respectively (default is mmap ). An example script to prepare data for BERT training is: python tools/preprocess_data.py \ --input my-corpus.json \ --output-prefix my-bert \ --vocab bert-vocab.txt \ --dataset-impl mmap \ --tokenizer-type BertWordPieceLowerCase \ --split-sentences The output will be two files named, in this case, my-bert_text_sentence.bin and my-bert_text_sentence.idx . The --data-path specified in later BERT training is the full path and new filename, but without the file extension. Some minor modifications are required for GPT data preprocessing, namely, the addition of a merge table, an end-of-document token, removal of sentence splitting, and a change to the tokenizer type: python tools/preprocess_data.py \ --input my-corpus.json \ --output-prefix my-gpt2 \ --vocab gpt2-vocab.json \ --dataset-impl mmap \ --tokenizer-type GPT2BPETokenizer \ --merge-file gpt2-merges.txt \ --append-eod Here the output files are named my-gpt2_text_document.bin and my-gpt2_text_document.idx . As before, in GPT training, use the longer name without the extension as --data-path . Further command line arguments are described in the source file preprocess_data.py . BERT Pretraining bash examples/pretrain_bert.sh This script runs single GPU 345M parameter BERT pretraining. Debugging is the primary use for single GPU training, as the code base and command line arguments are optimized for highly distributed training. Most of the arguments are fairly self-explanatory. By default, the learning rate decays linearly over the training iterations starting at --lr to a minimum set by --min-lr over --lr-decay-iters iterations. The fraction of training iterations used for warmup is set by --lr-warmup-fraction . While this is single GPU training, the batch size specified by --micro-batch-size is a single forward-backward path batch-size and the code will perform gradient accumulation steps until it reaches global-batch-size whcih is the batch size per iteration. The data is partitioned into a 949:50:1 ratio for training/validation/test sets (default is 969:30:1). This partitioning happens on the fly, but is consistent across runs with the same random seed (1234 by default, or specified manually with --seed ). We use train-iters as the training iterations requested. Alternatively, one can provide --train-samples which is total number of samples to train on. If this option is present, then instead of providing --lr-decay-iters , one will need to provide --lr-decay-samples . The logging, checkpoint-saving, and evaluation intervals are specified. Checkpointing the activations facilitates the training of larger models and/or batches. Note that the --data-path now includes the additional _text_sentence suffix added in preprocessing, but does not include the file extensions. CHECKPOINT_PATH=checkpoints/bert_345m VOCAB_FILE=bert-vocab.txt DATA_PATH=my-bert_text_sentence BERT_ARGS="--num-layers 24 \ --hidden-size 1024 \ --num-attention-heads 16 \ --seq-length 512 \ --max-position-embeddings 512 \ --lr 0.0001 \ --lr-decay-iters 990000 \ --train-iters 2000000 \ --min-lr 0.00001 \ --lr-warmup-fraction 0.01 \ --micro-batch-size 4 \ --global-batch-size 8 \ --vocab-file $VOCAB_FILE \ --split 949,50,1 \ --fp16" OUTPUT_ARGS="--log-interval 10 \ --save-interval 500 \ --eval-interval 100 \ --eval-iters 10 \ --checkpoint-activations" python pretrain_bert.py \ $BERT_ARGS \ $OUTPUT_ARGS \ --save $CHECKPOINT_PATH \ --load $CHECKPOINT_PATH \ --data-path $DATA_PATH Further command line arguments are described in the source file arguments.py . GPT Pretraining bash examples/pretrain_gpt.sh This script runs single GPU 345M parameter GPT pretraining. As mentioned above, single GPU training is primarily intended for debugging purposes, as the code is optimized for distributed training. It follows largely the same format as the previous BERT script with a few notable differences: the tokenization scheme used is BPE (which requires a merge table and a json vocabulary file) instead of WordPiece, the model architecture allows for longer sequences (note that the max position embedding must be greater than or equal to the maximum sequence length), and the --lr-decay-style has been set to cosine decay. Note that the --data-path now includes the additional _text_document suffix added in preprocessing, but does not include the file extensions. CHECKPOINT_PATH=checkpoints/gpt2_345m VOCAB_FILE=gpt2-vocab.json MERGE_FILE=gpt2-merges.txt DATA_PATH=my-gpt2_text_document GPT_ARGS="--num-layers 24 \ --hidden-size 1024 \ --num-attention-heads 16 \ --seq-length 1024 \ --max-position-embeddings 1024 \ --micro-batch-size 4 \ --global-batch-size 8 \ --lr 0.00015 \ --train-iters 500000 \ --lr-decay-iters 320000 \ --lr-decay-style cosine \ --vocab-file $VOCAB_FILE \ --merge-file $MERGE_FILE \ --lr-warmup-fraction .01 \ --fp16" OUTPUT_ARGS=&lt;same as those in BERT pretraining above&gt; python pretrain_gpt.py \ $GPT_ARGS \ $OUTPUT_ARGS \ --save $CHECKPOINT_PATH \ --load $CHECKPOINT_PATH \ --data-path $DATA_PATH \ Further command line arguments are described in the source file arguments.py . Distributed BERT or GPT Pretraining bash examples/pretrain_bert_distributed.sh bash examples/pretrain_gpt_distributed.sh These scripts use the PyTorch distributed launcher for distributed training. As such, multi-node training can be achieved by properly setting environment variables and using init_method='env://' in the launcher. See the official PyTorch documentation for further description of these environment variables . By default, multi-node training uses the nccl distributed backend. A simple set of additional arguments and the use of the PyTorch distributed module with the Python flag -m torch.distributed.launch , detailed below, are the only additional requirements to adopt distributed training. We use two types of parallelism: data and model parallelism. We facilitate two distributed data parallel implementations: a simple one of our own that performs gradient all-reduce at the end of back propagation step, and Torch's distributed data parallel wrapper that overlaps gradient reduction with back propagation computation. To switch between these two options use --DDP-impl local or --DDP-impl torch , respectively. As expected, Torch distributed data parallelism is more efficient at larger model sizes. For example, for the 8.3 billion parameters model running on 512 GPUs, the scaling increases from 60% to 76% when Torch's distributed data parallel is used. However, the overlapping method requires more memory and for some configurations (e.g., 2.5 billion parameters using 2-way model parallel and 1.2 billion parameters with no model parallel) can make the overall training slower as a result. We empirically found that using a smaller model in those cases improves the training time. Second, we developed a simple and efficient two-dimensional model-parallel approach. To use tensor model parallelism (splitting execution of a single transformer module over multiple GPUs), add the --tensor-model-parallel-size flag to specify the number of GPUs among which to split the model, along with the arguments passed to the distributed launcher as mentioned above. To use pipeline model parallelism (sharding the transformer modules into stages with an equal number of transformer modules on each stage, and then pipelining execution by breaking the batch into smaller microbatches), use the --pipeline-model-parallel-size flag to specify the number of stages to split the model into (e.g., splitting a model with 24 transformer layers across 4 stages would mean each stage gets 6 transformer layers each). We have examples of how to use these two different forms of model parallelism in these scripts: bash examples/pretrain_bert_distributed_with_mp.sh bash examples/pretrain_gpt_distributed_with_mp.sh Other than these minor changes, the distributed training is identical to the training on a single GPU. Distributed BERT training: WORLD_SIZE=8 MP_SIZE=2 DISTRIBUTED_ARGS="--nproc_per_node $WORLD_SIZE \ --nnodes 1 \ --node_rank 0 \ --master_addr localhost \ --master_port 6000" CHECKPOINT_PATH=checkpoints/bert_345m VOCAB_FILE=bert-vocab.txt DATA_PATH=my-bert_text_sentence BERT_ARGS=&lt;same as those in BERT pretraining above&gt; OUTPUT_ARGS=&lt;same as those in BERT pretraining above&gt; python -m torch.distributed.launch $DISTRIBUTED_ARGS ./pretrain_bert.py \ $BERT_ARGS \ $OUTPUT_ARGS \ --save $CHECKPOINT_PATH \ --load $CHECKPOINT_PATH \ --data-path $DATA_PATH \ --tensor-model-parallel-size $MP_SIZE \ --DDP-impl torch Distributed GPT training: WORLD_SIZE=8 MP_SIZE=2 DISTRIBUTED_ARGS=&lt;same as those directly above&gt; CHECKPOINT_PATH=checkpoints/gpt2_345m VOCAB_FILE=gpt2-vocab.json MERGE_FILE=gpt2-merges.txt DATA_PATH=my-gpt2_text_document GPT_ARGS=&lt;same as those in GPT pretraining above&gt; OUTPUT_ARGS=&lt;same as those in BERT pretraining above&gt; python -m torch.distributed.launch $DISTRIBUTED_ARGS ./pretrain_gpt.py \ $GPT_ARGS \ $OUTPUT_ARGS \ --save $CHECKPOINT_PATH \ --load $CHECKPOINT_PATH \ --data-path $DATA_PATH \ --tensor-model-parallel-size $MP_SIZE \ --DDP-impl torch GPT-3 Example bash examples/pretrain_gpt3_175B.sh We have provided an example of how to configure Megatron to run GPT-3 with 175 billion parameters on 1024 GPUs. The script is designed for slurm with pyxis plugin but can be easily adopted to any other scheduler. It uses 8-way and 16-way tensor and pipeline parallelism, respectively. With options global-batch-size 1536 and rampup-batch-size 16 16 5859375 , the training will start with global batch size 16 and linearly increase the global batch size to 1536 over 5,859,375 samples with incrmeental steps 16. The training dataset can be either a single set or a multiple datasets combined with a set of weights. With full global batch size of 1536 on 1024 A100 GPUs, each iteration takes around 32 seconds resulting in 138 teraFLOPs per GPU which is 44% of the theoretical peak FLOPs. Evaluation and Tasks We provide several command line arguments, detailed in the scripts listed below, to handle various zero-shot and fine-tuned downstream tasks. However, you can also finetune your model from a pretrained checkpoint on other corpora as desired. To do so, simply add the --finetune flag and adjust the input files and training parameters within the original training script. The iteration count will be reset to zero, and the optimizer and internal state will be reinitialized. If the fine-tuning is interrupted for any reason, be sure to remove the --finetune flag before continuing, otherwise the training will start again from the beginning. Several downstream tasks are described for both GPT and BERT models below. They can be run in distributed and model parallel modes with the same changes used in the training scripts. GPT Text Generation bash examples/generate_text.sh We generate text samples using largely the GPT pretraining script. Few changes need to make, such as we need to provide the path to the pretrained checkpoint, the length of the output samples, whether to generate texts unconditionally ( --num-samples to denote how many samples to generate) or conditional (need to pass --sample-input-file &lt;filename&gt; where each line of the file will be used as the conditional texts). There are few optional parameters to play, e.g. top-k , top-p , or greedy (set top-k and top-p to 0) sampling.. CHECKPOINT_PATH=checkpoints/gpt2_345m VOCAB_FILE=gpt2-vocab.json MERGE_FILE=gpt2-merges.txt GPT_ARGS=&lt;same as those in GPT pretraining above&gt; MAX_OUTPUT_SEQUENCE_LENGTH=1024 TEMPERATURE=1.0 TOP_P=0.9 NUMBER_OF_SAMPLES=2 OUTPUT_FILE=samples.json python tools/generate_samples_gpt.py \ $GPT_ARGS \ --load $CHECKPOINT_PATH \ --out-seq-length $MAX_OUTPUT_SEQUENCE_LENGTH \ --temperature $TEMPERATURE \ --genfile $OUTPUT_FILE \ --num-samples $NUMBER_OF_SAMPLES \ --top_p $TOP_P \ --recompute GPT Evaluation We include example scripts for GPT evaluation on WikiText perplexity evaluation and LAMBADA Cloze accuracy. WikiText Perplexity Evaluation For even comparison with prior works, we evaluate perplexity on the word-level WikiText-103 test dataset , and appropriately compute perplexity given the change in tokens when using our subword tokenizer. We use the following command to run WikiText-103 evaluation on a 345M parameter model. TASK="WIKITEXT103" VALID_DATA=&lt;wikitext path&gt;.txt VOCAB_FILE=gpt2-vocab.json MERGE_FILE=gpt2-merges.txt CHECKPOINT_PATH=checkpoints/gpt2_345m COMMON_TASK_ARGS="--num-layers 24 \ --hidden-size 1024 \ --num-attention-heads 16 \ --seq-length 1024 \ --max-position-embeddings 1024 \ --fp16 \ --vocab-file $VOCAB_FILE" python tasks/main.py \ --task $TASK \ $COMMON_TASK_ARGS \ --valid-data $VALID_DATA \ --tokenizer-type GPT2BPETokenizer \ --merge-file $MERGE_FILE \ --load $CHECKPOINT_PATH \ --micro-batch-size 8 \ --checkpoint-activations \ --log-interval 10 \ --no-load-optim \ --no-load-rng LAMBADA Cloze Accuracy To compute LAMBADA cloze accuracy (the accuracy of predicting the last token given the preceeding tokens) we utilize a detokenized, processed version of the LAMBADA dataset . We use the following command to run LAMBADA evaluation on a 345M parameter model. Note that the --strict-lambada flag should be used to require whole word matching. Make that lambada is part of the file path. TASK="LAMBADA" VALID_DATA=&lt;lambada path&gt;.json VOCAB_FILE=gpt2-vocab.json MERGE_FILE=gpt2-merges.txt CHECKPOINT_PATH=checkpoints/gpt2_345m COMMON_TASK_ARGS=&lt;same as those in WikiText Perplexity Evaluation above&gt; python tasks/main.py \ --task $TASK \ $COMMON_TASK_ARGS \ --valid-data $VALID_DATA \ --tokenizer-type GPT2BPETokenizer \ --strict-lambada \ --merge-file $MERGE_FILE \ --load $CHECKPOINT_PATH \ --micro-batch-size 8 \ --checkpoint-activations \ --log-interval 10 \ --no-load-optim \ --no-load-rng Further command line arguments are described in the source file main.py BERT Task Evaluation RACE Evaluation The following script finetunes the BERT model for evaluation on the RACE dataset . The TRAIN_DATA and VALID_DATA directory contain the RACE dataset as separate .txt files. Note that for RACE, the batch size is the number of RACE query's to evaluate. Since each RACE query has four samples, the effective batch size passed through the model will be four times the batch size specified on the command line. TRAIN_DATA="data/RACE/train/middle" VALID_DATA="data/RACE/dev/middle \ data/RACE/dev/high" VOCAB_FILE=bert-vocab.txt PRETRAINED_CHECKPOINT=checkpoints/bert_345m CHECKPOINT_PATH=checkpoints/bert_345m_race COMMON_TASK_ARGS="--num-layers 24 \ --hidden-size 1024 \ --num-attention-heads 16 \ --seq-length 512 \ --max-position-embeddings 512 \ --fp16 \ --vocab-file $VOCAB_FILE" COMMON_TASK_ARGS_EXT="--train-data $TRAIN_DATA \ --valid-data $VALID_DATA \ --pretrained-checkpoint $PRETRAINED_CHECKPOINT \ --checkpoint-activations \ --save-interval 10000 \ --save $CHECKPOINT_PATH \ --log-interval 100 \ --eval-interval 1000 \ --eval-iters 10 \ --weight-decay 1.0e-1" python tasks/main.py \ --task RACE \ $COMMON_TASK_ARGS \ $COMMON_TASK_ARGS_EXT \ --tokenizer-type BertWordPieceLowerCase \ --epochs 3 \ --micro-batch-size 4 \ --lr 1.0e-5 \ --lr-warmup-fraction 0.06 MNLI Evaluation The following script finetunes the BERT model for evaluation with the MultiNLI sentence pair corpus . Because the matching tasks are quite similar, the script can be quickly tweaked to work with the Quora Question Pairs (QQP) dataset as well. TRAIN_DATA="data/glue_data/MNLI/train.tsv" VALID_DATA="data/glue_data/MNLI/dev_matched.tsv \ data/glue_data/MNLI/dev_mismatched.tsv" PRETRAINED_CHECKPOINT=checkpoints/bert_345m VOCAB_FILE=bert-vocab.txt CHECKPOINT_PATH=checkpoints/bert_345m_mnli COMMON_TASK_ARGS=&lt;same as those in RACE Evaluation above&gt; COMMON_TASK_ARGS_EXT=&lt;same as those in RACE Evaluation above&gt; python tasks/main.py \ --task MNLI \ $COMMON_TASK_ARGS \ $COMMON_TASK_ARGS_EXT \ --tokenizer-type BertWordPieceLowerCase \ --epochs 5 \ --micro-batch-size 8 \ --lr 5.0e-5 \ --lr-warmup-fraction 0.065 Datasets We do not host any datasets for GPT or BERT training, however, we detail their collection so that our results may be reproduced. Collecting Wikipedia Training Data We recommend following the Wikipedia data extraction process specified by Google research: "the recommended pre-processing is to download the latest dump , extract the text with WikiExtractor.py , and then apply any necessary cleanup to convert it into plain text." We recommend using the --json argument when using WikiExtractor, which will dump the Wikipedia data into loose json format (one json per line), making it more manageable on the file system and also readily consumable by our codebase. We recommend further preprocessing this json dataset by nltk punctuation standardization. For BERT training, use the --split-sentences flag to preprocess_data.py as described above to include sentence breaks in the produced index. If you'd like to use Wikipedia data for GPT training you should still clean it with nltk/spacy/ftfy, but do not use the --split-sentences flag. Collecting GPT Webtext Data We utilize the publicly available OpenWebText library from jcpeterson and eukaryote31's work to download urls. We then filtered, cleaned, and deduplicated all downloaded content according to the procedure described in our openwebtext directory. For reddit URLs corresponding to content up to October 2018 we arrived at approximately 37GB of content. About Ongoing research training transformer language models at scale, including: BERT &amp; GPT-2 Resources Readme License View license Releases 7 BERT mixed precision training Latest <relative-time datetime="2019-03-27T21:06:33Z" class="no-wrap">Mar 27, 2019 + 6 releases Packages 0 No packages published <include-fragment src="/NVIDIA/Megatron-LM/used_by_list" accept="text/fragment+html"> Contributors 13 + 2 contributors Languages Python 84.9% C++ 10.6% Cuda 4.1% TeX 0.2% C 0.1% Makefile 0.1% &copy; 2021 GitHub, Inc. Terms Privacy Security Status Docs Contact GitHub Pricing API Training Blog About You can’t perform that action at this time. You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast hx_rsm-dialog hx_rsm-modal"> 
<p>

<h2>
Base = <a href=""></a>
</h2>

<h2>
Links
</h2>
<p>
<a href="#start-of-content">#start-of-content</a> ( Skip to content )
</p>
<p>
<a href="https://github.com/">https://github.com/</a> ( )
</p>
<p>
<a href="/join?ref_cta=Sign+up&amp;ref_loc=header+logged+out&amp;ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&amp;source=header-repo">/join?ref_cta=Sign+up&amp;ref_loc=header+logged+out&amp;ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&amp;source=header-repo</a> ( Sign&nbsp;up )
</p>
<p>
<a href="/join_next?ref_cta=Sign+up&amp;ref_loc=header+logged+out&amp;ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&amp;source=header-repo">/join_next?ref_cta=Sign+up&amp;ref_loc=header+logged+out&amp;ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&amp;source=header-repo</a> ( Sign&nbsp;up )
</p>
<p>
<a href="/features">/features</a> ( Features &rarr; )
</p>
<p>
<a href="/mobile">/mobile</a> ( Mobile &rarr; )
</p>
<p>
<a href="/features/actions">/features/actions</a> ( Actions &rarr; )
</p>
<p>
<a href="/features/codespaces">/features/codespaces</a> ( Codespaces &rarr; )
</p>
<p>
<a href="/features/packages">/features/packages</a> ( Packages &rarr; )
</p>
<p>
<a href="/features/security">/features/security</a> ( Security &rarr; )
</p>
<p>
<a href="/features/code-review/">/features/code-review/</a> ( Code review &rarr; )
</p>
<p>
<a href="/features/project-management/">/features/project-management/</a> ( Project management &rarr; )
</p>
<p>
<a href="/features/integrations">/features/integrations</a> ( Integrations &rarr; )
</p>
<p>
<a href="/sponsors">/sponsors</a> ( GitHub Sponsors &rarr; )
</p>
<p>
<a href="/customer-stories">/customer-stories</a> ( Customer stories &rarr; )
</p>
<p>
<a href="/team">/team</a> ( Team )
</p>
<p>
<a href="/enterprise">/enterprise</a> ( Enterprise )
</p>
<p>
<a href="/explore">/explore</a> ( Explore GitHub &rarr; )
</p>
<p>
<a href="/topics">/topics</a> ( Topics &rarr; )
</p>
<p>
<a href="/collections">/collections</a> ( Collections &rarr; )
</p>
<p>
<a href="/trending">/trending</a> ( Trending &rarr; )
</p>
<p>
<a href="https://lab.github.com/">https://lab.github.com/</a> ( Learning Lab &rarr; )
</p>
<p>
<a href="https://opensource.guide">https://opensource.guide</a> ( Open source guides &rarr; )
</p>
<p>
<a href="https://github.com/readme">https://github.com/readme</a> ( The ReadME Project &rarr; )
</p>
<p>
<a href="https://github.com/events">https://github.com/events</a> ( Events &rarr; )
</p>
<p>
<a href="https://github.community">https://github.community</a> ( Community forum &rarr; )
</p>
<p>
<a href="https://education.github.com">https://education.github.com</a> ( GitHub Education &rarr; )
</p>
<p>
<a href="https://stars.github.com">https://stars.github.com</a> ( GitHub Stars program &rarr; )
</p>
<p>
<a href="/marketplace">/marketplace</a> ( Marketplace )
</p>
<p>
<a href="/pricing">/pricing</a> ( Plans &rarr; )
</p>
<p>
<a href="/pricing#feature-comparison">/pricing#feature-comparison</a> ( Compare plans &rarr; )
</p>
<p>
<a href="https://enterprise.github.com/contact">https://enterprise.github.com/contact</a> ( Contact Sales &rarr; )
</p>
<p>
<a href="https://education.github.com">https://education.github.com</a> ( Education &rarr; )
</p>
<p>
<a href=""></a> ( )
</p>
<p>
<a href=""></a> ( )
</p>
<p>
<a href=""></a> ( )
</p>
<p>
<a href=""></a> ( )
</p>
<p>
<a href="/login?return_to=%2FNVIDIA%2FMegatron-LM">/login?return_to=%2FNVIDIA%2FMegatron-LM</a> ( Sign in )
</p>
<p>
<a href="/join?ref_cta=Sign+up&amp;ref_loc=header+logged+out&amp;ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&amp;source=header-repo&amp;source_repo=NVIDIA%2FMegatron-LM">/join?ref_cta=Sign+up&amp;ref_loc=header+logged+out&amp;ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&amp;source=header-repo&amp;source_repo=NVIDIA%2FMegatron-LM</a> ( Sign up )
</p>
<p>
<a href="/join_next?ref_cta=Sign+up&amp;ref_loc=header+logged+out&amp;ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&amp;source=header-repo&amp;source_repo=NVIDIA%2FMegatron-LM">/join_next?ref_cta=Sign+up&amp;ref_loc=header+logged+out&amp;ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&amp;source=header-repo&amp;source_repo=NVIDIA%2FMegatron-LM</a> ( Sign up )
</p>
<p>
<a href="/NVIDIA">/NVIDIA</a> ( NVIDIA )
</p>
<p>
<a href="/NVIDIA/Megatron-LM">/NVIDIA/Megatron-LM</a> ( Megatron-LM )
</p>
<p>
<a href="/login?return_to=%2FNVIDIA%2FMegatron-LM">/login?return_to=%2FNVIDIA%2FMegatron-LM</a> ( Notifications )
</p>
<p>
<a href="/login?return_to=%2FNVIDIA%2FMegatron-LM">/login?return_to=%2FNVIDIA%2FMegatron-LM</a> ( Star )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/stargazers">/NVIDIA/Megatron-LM/stargazers</a> ( 1.8k )
</p>
<p>
<a href="/login?return_to=%2FNVIDIA%2FMegatron-LM">/login?return_to=%2FNVIDIA%2FMegatron-LM</a> ( Fork )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/network/members">/NVIDIA/Megatron-LM/network/members</a> ( 347 )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/LICENSE">/NVIDIA/Megatron-LM/blob/main/LICENSE</a> ( View license )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/stargazers">/NVIDIA/Megatron-LM/stargazers</a> ( 1.8k stars )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/network/members">/NVIDIA/Megatron-LM/network/members</a> ( 347 forks )
</p>
<p>
<a href="/login?return_to=%2FNVIDIA%2FMegatron-LM">/login?return_to=%2FNVIDIA%2FMegatron-LM</a> ( Star )
</p>
<p>
<a href="/login?return_to=%2FNVIDIA%2FMegatron-LM">/login?return_to=%2FNVIDIA%2FMegatron-LM</a> ( Notifications )
</p>
<p>
<a href="/NVIDIA/Megatron-LM">/NVIDIA/Megatron-LM</a> ( Code )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/issues">/NVIDIA/Megatron-LM/issues</a> ( Issues 47 )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/pulls">/NVIDIA/Megatron-LM/pulls</a> ( Pull requests 8 )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/actions">/NVIDIA/Megatron-LM/actions</a> ( Actions )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/security">/NVIDIA/Megatron-LM/security</a> ( Security <include-fragment src="/NVIDIA/Megatron-LM/security/overall-count" accept="text/fragment+html"> )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/pulse">/NVIDIA/Megatron-LM/pulse</a> ( Insights )
</p>
<p>
<a href="/NVIDIA/Megatron-LM">/NVIDIA/Megatron-LM</a> ( Code )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/issues">/NVIDIA/Megatron-LM/issues</a> ( Issues )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/pulls">/NVIDIA/Megatron-LM/pulls</a> ( Pull requests )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/actions">/NVIDIA/Megatron-LM/actions</a> ( Actions )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/security">/NVIDIA/Megatron-LM/security</a> ( Security )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/pulse">/NVIDIA/Megatron-LM/pulse</a> ( Insights )
</p>
<p>
<a href="https://github.com/NVIDIA/Megatron-LM/tree/{{ urlEncodedRefName }}">https://github.com/NVIDIA/Megatron-LM/tree/{{ urlEncodedRefName }}</a> ( {{ refName }} default )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/branches">/NVIDIA/Megatron-LM/branches</a> ( View all branches )
</p>
<p>
<a href="https://github.com/NVIDIA/Megatron-LM/tree/{{ urlEncodedRefName }}">https://github.com/NVIDIA/Megatron-LM/tree/{{ urlEncodedRefName }}</a> ( {{ refName }} default )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/tags">/NVIDIA/Megatron-LM/tags</a> ( View all tags )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/branches">/NVIDIA/Megatron-LM/branches</a> ( 2 branches )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/tags">/NVIDIA/Megatron-LM/tags</a> ( 7 tags )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/find/main">/NVIDIA/Megatron-LM/find/main</a> ( Go to file )
</p>
<p>
<a href="https://docs.github.com/articles/which-remote-url-should-i-use">https://docs.github.com/articles/which-remote-url-should-i-use</a> ( )
</p>
<p>
<a href="https://cli.github.com">https://cli.github.com</a> ( Learn more )
</p>
<p>
<a href="https://desktop.github.com">https://desktop.github.com</a> ( Open with GitHub Desktop )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/archive/refs/heads/main.zip">/NVIDIA/Megatron-LM/archive/refs/heads/main.zip</a> ( Download ZIP )
</p>
<p>
<a href="https://desktop.github.com/">https://desktop.github.com/</a> ( download GitHub Desktop )
</p>
<p>
<a href="https://desktop.github.com/">https://desktop.github.com/</a> ( download GitHub Desktop )
</p>
<p>
<a href="https://developer.apple.com/xcode/">https://developer.apple.com/xcode/</a> ( download Xcode )
</p>
<p>
<a href="https://visualstudio.github.com/">https://visualstudio.github.com/</a> ( download the GitHub extension for Visual Studio )
</p>
<p>
<a href="/jaredcasper">/jaredcasper</a> ( )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commits?author=jaredcasper">/NVIDIA/Megatron-LM/commits?author=jaredcasper</a> ( jaredcasper )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commit/8aa4619f2b2a57b5725026a50ebd2b15e8121482">/NVIDIA/Megatron-LM/commit/8aa4619f2b2a57b5725026a50ebd2b15e8121482</a> ( Cherry-pick fix from development repo. )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commit/8aa4619f2b2a57b5725026a50ebd2b15e8121482">/NVIDIA/Megatron-LM/commit/8aa4619f2b2a57b5725026a50ebd2b15e8121482</a> ( 8aa4619 )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commit/8aa4619f2b2a57b5725026a50ebd2b15e8121482">/NVIDIA/Megatron-LM/commit/8aa4619f2b2a57b5725026a50ebd2b15e8121482</a> ( <relative-time datetime="2021-03-22T19:54:02Z" class="no-wrap">Mar 23, 2021 )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commit/8aa4619f2b2a57b5725026a50ebd2b15e8121482">/NVIDIA/Megatron-LM/commit/8aa4619f2b2a57b5725026a50ebd2b15e8121482</a> ( Cherry-pick fix from development repo. )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commits/main">/NVIDIA/Megatron-LM/commits/main</a> ( 656 commits )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/tree/8aa4619f2b2a57b5725026a50ebd2b15e8121482">/NVIDIA/Megatron-LM/tree/8aa4619f2b2a57b5725026a50ebd2b15e8121482</a> ( Permalink )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/tree/main/examples">/NVIDIA/Megatron-LM/tree/main/examples</a> ( examples )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commit/152aab304d4eabe4f992def6296156642e11c28d">/NVIDIA/Megatron-LM/commit/152aab304d4eabe4f992def6296156642e11c28d</a> ( Readme update + change gpt2 to gpt )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/tree/main/images">/NVIDIA/Megatron-LM/tree/main/images</a> ( images )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commit/152aab304d4eabe4f992def6296156642e11c28d">/NVIDIA/Megatron-LM/commit/152aab304d4eabe4f992def6296156642e11c28d</a> ( Readme update + change gpt2 to gpt )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/tree/main/megatron">/NVIDIA/Megatron-LM/tree/main/megatron</a> ( megatron )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commit/8aa4619f2b2a57b5725026a50ebd2b15e8121482">/NVIDIA/Megatron-LM/commit/8aa4619f2b2a57b5725026a50ebd2b15e8121482</a> ( Cherry-pick fix from development repo. )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/tree/main/tasks">/NVIDIA/Megatron-LM/tree/main/tasks</a> ( tasks )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commit/a13cbe1e283870e30461dc5c049639bf6909672f">/NVIDIA/Megatron-LM/commit/a13cbe1e283870e30461dc5c049639bf6909672f</a> ( Use new api to get loss scale when finetuning. )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/tree/main/tools">/NVIDIA/Megatron-LM/tree/main/tools</a> ( tools )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commit/152aab304d4eabe4f992def6296156642e11c28d">/NVIDIA/Megatron-LM/commit/152aab304d4eabe4f992def6296156642e11c28d</a> ( Readme update + change gpt2 to gpt )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/.gitignore">/NVIDIA/Megatron-LM/blob/main/.gitignore</a> ( .gitignore )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commit/bf1daf869d3ed0e811400dd37caaa4f9676f25a9">/NVIDIA/Megatron-LM/commit/bf1daf869d3ed0e811400dd37caaa4f9676f25a9</a> ( pip support added )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/LICENSE">/NVIDIA/Megatron-LM/blob/main/LICENSE</a> ( LICENSE )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commit/39af7956439a39f27a4891eb2d2e7f2586afecbb">/NVIDIA/Megatron-LM/commit/39af7956439a39f27a4891eb2d2e7f2586afecbb</a> ( make minor modifications to licnese wording )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/MANIFEST.in">/NVIDIA/Megatron-LM/blob/main/MANIFEST.in</a> ( MANIFEST.in )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commit/dd4832950a9b4c45be405ebcf180cc29e6aa6d15">/NVIDIA/Megatron-LM/commit/dd4832950a9b4c45be405ebcf180cc29e6aa6d15</a> ( helpers.cpp suupport added, version changed, clean up )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/README.md">/NVIDIA/Megatron-LM/blob/main/README.md</a> ( README.md )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commit/31733784715ce0887271f3e2841358474af33e42">/NVIDIA/Megatron-LM/commit/31733784715ce0887271f3e2841358474af33e42</a> ( TOC fix )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/pretrain_bert.py">/NVIDIA/Megatron-LM/blob/main/pretrain_bert.py</a> ( pretrain_bert.py )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commit/b81cad6609c9d91efa5701a3bdc71fc2f007d65b">/NVIDIA/Megatron-LM/commit/b81cad6609c9d91efa5701a3bdc71fc2f007d65b</a> ( Fix TensorBoard writes )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/pretrain_gpt.py">/NVIDIA/Megatron-LM/blob/main/pretrain_gpt.py</a> ( pretrain_gpt.py )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commit/152aab304d4eabe4f992def6296156642e11c28d">/NVIDIA/Megatron-LM/commit/152aab304d4eabe4f992def6296156642e11c28d</a> ( Readme update + change gpt2 to gpt )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/pretrain_ict.py">/NVIDIA/Megatron-LM/blob/main/pretrain_ict.py</a> ( pretrain_ict.py )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commit/b81cad6609c9d91efa5701a3bdc71fc2f007d65b">/NVIDIA/Megatron-LM/commit/b81cad6609c9d91efa5701a3bdc71fc2f007d65b</a> ( Fix TensorBoard writes )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/requirements.txt">/NVIDIA/Megatron-LM/blob/main/requirements.txt</a> ( requirements.txt )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commit/73fef4fc77b78e489d1e2d66dbb8bc047610d8cc">/NVIDIA/Megatron-LM/commit/73fef4fc77b78e489d1e2d66dbb8bc047610d8cc</a> ( update2 )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/setup.py">/NVIDIA/Megatron-LM/blob/main/setup.py</a> ( setup.py )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/commit/faa462fa47eb6bb4e089727021488f9da1ed318f">/NVIDIA/Megatron-LM/commit/faa462fa47eb6bb4e089727021488f9da1ed318f</a> ( update )
</p>
<p>
<a href="https://arxiv.org/pdf/1909.08053.pdf">https://arxiv.org/pdf/1909.08053.pdf</a> ( Megatron )
</p>
<p>
<a href="https://arxiv.org/abs/2005.14165">https://arxiv.org/abs/2005.14165</a> ( GPT )
</p>
<p>
<a href="https://arxiv.org/pdf/1810.04805.pdf">https://arxiv.org/pdf/1810.04805.pdf</a> ( BERT )
</p>
<p>
<a href="https://arxiv.org/pdf/1909.08053.pdf">https://arxiv.org/pdf/1909.08053.pdf</a> ( BERT and GPT Studies Using Megatron )
</p>
<p>
<a href="https://www.aclweb.org/anthology/2020.emnlp-main.379.pdf">https://www.aclweb.org/anthology/2020.emnlp-main.379.pdf</a> ( BioMegatron: Larger Biomedical Domain Language Model )
</p>
<p>
<a href="https://arxiv.org/abs/2101.00408">https://arxiv.org/abs/2101.00408</a> ( End-to-End Training of Neural Retrievers for Open-Domain Question Answering )
</p>
<p>
<a href="https://www.aclweb.org/anthology/2020.acl-main.8.pdf">https://www.aclweb.org/anthology/2020.acl-main.8.pdf</a> ( Large Scale Multi-Actor Generative Dialog Modeling )
</p>
<p>
<a href="https://arxiv.org/abs/2010.10150">https://arxiv.org/abs/2010.10150</a> ( Local Knowledge Powered Conversational Agents )
</p>
<p>
<a href="https://www.aclweb.org/anthology/2020.emnlp-main.226.pdf">https://www.aclweb.org/anthology/2020.emnlp-main.226.pdf</a> ( MEGATRON-CNTRL: Controllable Story Generation with External Knowledge Using Large-Scale Language Models )
</p>
<p>
<a href="http://www.qizhexie.com/data/RACE_leaderboard.html">http://www.qizhexie.com/data/RACE_leaderboard.html</a> ( RACE Reading Comprehension Dataset Leaderboard )
</p>
<p>
<a href="https://www.aclweb.org/anthology/2020.emnlp-main.468.pdf">https://www.aclweb.org/anthology/2020.emnlp-main.468.pdf</a> ( Training Question Answering Models From Synthetic Data )
</p>
<p>
<a href="https://www.top500.org/system/179842/">https://www.top500.org/system/179842/</a> ( NVIDIA's Selene supercomputer )
</p>
<p>
<a href="https://www.nvidia.com/en-us/data-center/a100/">https://www.nvidia.com/en-us/data-center/a100/</a> ( A100 )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/images/cases_jan2021.png">/NVIDIA/Megatron-LM/blob/main/images/cases_jan2021.png</a> ( )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/images/scaling.png">/NVIDIA/Megatron-LM/blob/main/images/scaling.png</a> ( )
</p>
<p>
<a href="#contents">#contents</a> ( )
</p>
<p>
<a href="#contents">#contents</a> ( Contents )
</p>
<p>
<a href="#setup">#setup</a> ( Setup )
</p>
<p>
<a href="#downloading-checkpoints">#downloading-checkpoints</a> ( Downloading Checkpoints )
</p>
<p>
<a href="#usage">#usage</a> ( Usage )
</p>
<p>
<a href="#training">#training</a> ( Training )
</p>
<p>
<a href="#data-preprocessing">#data-preprocessing</a> ( Data Preprocessing )
</p>
<p>
<a href="#bert-pretraining">#bert-pretraining</a> ( BERT Pretraining )
</p>
<p>
<a href="#gpt-pretraining">#gpt-pretraining</a> ( GPT Pretraining )
</p>
<p>
<a href="#distributed-bert-or-gpt-pretraining">#distributed-bert-or-gpt-pretraining</a> ( Distributed BERT or GPT Pretraining )
</p>
<p>
<a href="#gpt-3-example">#gpt-3-example</a> ( GPT-3 Example )
</p>
<p>
<a href="#evaluation-and-tasks">#evaluation-and-tasks</a> ( Evaluation and Tasks )
</p>
<p>
<a href="#gpt-text-generation">#gpt-text-generation</a> ( GPT Text Generation )
</p>
<p>
<a href="#gpt-evaluation">#gpt-evaluation</a> ( GPT Evaluation )
</p>
<p>
<a href="#wikitext-perplexity-evaluation">#wikitext-perplexity-evaluation</a> ( WikiText Perplexity Evaluation )
</p>
<p>
<a href="#lambada-cloze-accuracy">#lambada-cloze-accuracy</a> ( LAMBADA Cloze Accuracy )
</p>
<p>
<a href="#bert-task-evaluation">#bert-task-evaluation</a> ( BERT Task Evaluation )
</p>
<p>
<a href="#race-evaluation">#race-evaluation</a> ( RACE Evaluation )
</p>
<p>
<a href="#mnli-evaluation">#mnli-evaluation</a> ( MNLI Evaluation )
</p>
<p>
<a href="#datasets">#datasets</a> ( Datasets )
</p>
<p>
<a href="#collecting-wikipedia-training-data">#collecting-wikipedia-training-data</a> ( Collecting Wikipedia Training Data )
</p>
<p>
<a href="#collecting-gpt-webtext-data">#collecting-gpt-webtext-data</a> ( Collecting GPT Webtext Data )
</p>
<p>
<a href="#setup">#setup</a> ( )
</p>
<p>
<a href="https://ngc.nvidia.com/catalog/containers/nvidia:pytorch">https://ngc.nvidia.com/catalog/containers/nvidia:pytorch</a> ( NGC's PyTorch container )
</p>
<p>
<a href="https://github.com/NVIDIA/apex#quick-start">https://github.com/NVIDIA/apex#quick-start</a> ( APEX )
</p>
<p>
<a href="https://ngc.nvidia.com/catalog/containers/nvidia:pytorch">https://ngc.nvidia.com/catalog/containers/nvidia:pytorch</a> ( NGC's recent PyTorch containers )
</p>
<p>
<a href="https://www.nltk.org/install.html">https://www.nltk.org/install.html</a> ( NLTK )
</p>
<p>
<a href="#downloading-checkpoints">#downloading-checkpoints</a> ( )
</p>
<p>
<a href="https://ngc.nvidia.com/catalog/models/nvidia:megatron_bert_345m">https://ngc.nvidia.com/catalog/models/nvidia:megatron_bert_345m</a> ( BERT-345M )
</p>
<p>
<a href="https://ngc.nvidia.com/catalog/models/nvidia:megatron_lm_345m">https://ngc.nvidia.com/catalog/models/nvidia:megatron_lm_345m</a> ( GPT-345M )
</p>
<p>
<a href="https://ngc.nvidia.com/signup">https://ngc.nvidia.com/signup</a> ( sign up )
</p>
<p>
<a href="https://ngc.nvidia.com/setup/installers/cli">https://ngc.nvidia.com/setup/installers/cli</a> ( setup )
</p>
<p>
<a href="https://docs.nvidia.com/dgx/ngc-registry-cli-user-guide/index.html#topic_6_4_1">https://docs.nvidia.com/dgx/ngc-registry-cli-user-guide/index.html#topic_6_4_1</a> ( NGC documentation )
</p>
<p>
<a href="https://s3.amazonaws.com/models.huggingface.co/bert/bert-large-uncased-vocab.txt">https://s3.amazonaws.com/models.huggingface.co/bert/bert-large-uncased-vocab.txt</a> ( uncased )
</p>
<p>
<a href="https://s3.amazonaws.com/models.huggingface.co/bert/bert-large-cased-vocab.txt">https://s3.amazonaws.com/models.huggingface.co/bert/bert-large-cased-vocab.txt</a> ( cased )
</p>
<p>
<a href="https://s3.amazonaws.com/models.huggingface.co/bert/gpt2-vocab.json">https://s3.amazonaws.com/models.huggingface.co/bert/gpt2-vocab.json</a> ( vocab file )
</p>
<p>
<a href="https://s3.amazonaws.com/models.huggingface.co/bert/gpt2-merges.txt">https://s3.amazonaws.com/models.huggingface.co/bert/gpt2-merges.txt</a> ( merge table )
</p>
<p>
<a href="#usage">#usage</a> ( )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/examples">/NVIDIA/Megatron-LM/blob/main/examples</a> ( examples )
</p>
<p>
<a href="#training">#training</a> ( )
</p>
<p>
<a href="#data-preprocessing">#data-preprocessing</a> ( )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/tools/preprocess_data.py">/NVIDIA/Megatron-LM/blob/main/tools/preprocess_data.py</a> ( preprocess_data.py )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/tools/preprocess_data.py">/NVIDIA/Megatron-LM/blob/main/tools/preprocess_data.py</a> ( preprocess_data.py )
</p>
<p>
<a href="#bert-pretraining">#bert-pretraining</a> ( )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/megatron/arguments.py">/NVIDIA/Megatron-LM/blob/main/megatron/arguments.py</a> ( arguments.py )
</p>
<p>
<a href="#gpt-pretraining">#gpt-pretraining</a> ( )
</p>
<p>
<a href="#bert-pretraining">#bert-pretraining</a> ( BERT pretraining )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/megatron/arguments.py">/NVIDIA/Megatron-LM/blob/main/megatron/arguments.py</a> ( arguments.py )
</p>
<p>
<a href="#distributed-bert-or-gpt-pretraining">#distributed-bert-or-gpt-pretraining</a> ( )
</p>
<p>
<a href="https://pytorch.org/docs/stable/distributed.html#launch-utility">https://pytorch.org/docs/stable/distributed.html#launch-utility</a> ( documentation )
</p>
<p>
<a href="https://pytorch.org/docs/stable/distributed.html#environment-variable-initialization">https://pytorch.org/docs/stable/distributed.html#environment-variable-initialization</a> ( environment variables )
</p>
<p>
<a href="https://developer.nvidia.com/nccl">https://developer.nvidia.com/nccl</a> ( nccl )
</p>
<p>
<a href="#bert-pretraining">#bert-pretraining</a> ( BERT pretraining )
</p>
<p>
<a href="#bert-pretraining">#bert-pretraining</a> ( BERT pretraining )
</p>
<p>
<a href="#gpt-pretraining">#gpt-pretraining</a> ( GPT pretraining )
</p>
<p>
<a href="#bert-pretraining">#bert-pretraining</a> ( BERT pretraining )
</p>
<p>
<a href="#gpt-3-example">#gpt-3-example</a> ( )
</p>
<p>
<a href="https://arxiv.org/abs/2005.14165">https://arxiv.org/abs/2005.14165</a> ( GPT-3 )
</p>
<p>
<a href="https://slurm.schedmd.com/documentation.html">https://slurm.schedmd.com/documentation.html</a> ( slurm )
</p>
<p>
<a href="https://github.com/NVIDIA/pyxis">https://github.com/NVIDIA/pyxis</a> ( pyxis )
</p>
<p>
<a href="#evaluation-and-tasks">#evaluation-and-tasks</a> ( )
</p>
<p>
<a href="#gpt-text-generation">#gpt-text-generation</a> ( )
</p>
<p>
<a href="#gpt-pretraining">#gpt-pretraining</a> ( GPT pretraining )
</p>
<p>
<a href="#gpt-evaluation">#gpt-evaluation</a> ( )
</p>
<p>
<a href="#wikitext-perplexity-evaluation">#wikitext-perplexity-evaluation</a> ( )
</p>
<p>
<a href="https://s3.amazonaws.com/research.metamind.io/wikitext/wikitext-103-v1.zip">https://s3.amazonaws.com/research.metamind.io/wikitext/wikitext-103-v1.zip</a> ( WikiText-103 test dataset )
</p>
<p>
<a href="#lambada-cloze-accuracy">#lambada-cloze-accuracy</a> ( )
</p>
<p>
<a href="https://github.com/cybertronai/bflm/blob/master/lambada_test.jsonl">https://github.com/cybertronai/bflm/blob/master/lambada_test.jsonl</a> ( LAMBADA dataset )
</p>
<p>
<a href="#wikitext-perplexity-evaluation">#wikitext-perplexity-evaluation</a> ( WikiText Perplexity Evaluation )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/tasks/main.py">/NVIDIA/Megatron-LM/blob/main/tasks/main.py</a> ( main.py )
</p>
<p>
<a href="#bert-task-evaluation">#bert-task-evaluation</a> ( )
</p>
<p>
<a href="#race-evaluation">#race-evaluation</a> ( )
</p>
<p>
<a href="http://www.cs.cmu.edu/~glai1/data/race/">http://www.cs.cmu.edu/~glai1/data/race/</a> ( RACE dataset )
</p>
<p>
<a href="#mnli-evaluation">#mnli-evaluation</a> ( )
</p>
<p>
<a href="https://www.nyu.edu/projects/bowman/multinli/">https://www.nyu.edu/projects/bowman/multinli/</a> ( MultiNLI sentence pair corpus )
</p>
<p>
<a href="https://www.kaggle.com/quora/question-pairs-dataset">https://www.kaggle.com/quora/question-pairs-dataset</a> ( Quora Question Pairs )
</p>
<p>
<a href="#race-evaluation">#race-evaluation</a> ( RACE Evaluation )
</p>
<p>
<a href="#race-evaluation">#race-evaluation</a> ( RACE Evaluation )
</p>
<p>
<a href="#datasets">#datasets</a> ( )
</p>
<p>
<a href="#collecting-wikipedia-training-data">#collecting-wikipedia-training-data</a> ( )
</p>
<p>
<a href="https://dumps.wikimedia.org/enwiki/latest/enwiki-latest-pages-articles.xml.bz2">https://dumps.wikimedia.org/enwiki/latest/enwiki-latest-pages-articles.xml.bz2</a> ( the latest dump )
</p>
<p>
<a href="https://github.com/attardi/wikiextractor">https://github.com/attardi/wikiextractor</a> ( WikiExtractor.py )
</p>
<p>
<a href="#data-preprocessing">#data-preprocessing</a> ( above )
</p>
<p>
<a href="#collecting-gpt-webtext-data">#collecting-gpt-webtext-data</a> ( )
</p>
<p>
<a href="https://github.com/eukaryote31/openwebtext">https://github.com/eukaryote31/openwebtext</a> ( OpenWebText )
</p>
<p>
<a href="https://github.com/jcpeterson/openwebtext">https://github.com/jcpeterson/openwebtext</a> ( jcpeterson )
</p>
<p>
<a href="https://github.com/eukaryote31/openwebtext">https://github.com/eukaryote31/openwebtext</a> ( eukaryote31's )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/tools/openwebtext">/NVIDIA/Megatron-LM/blob/main/tools/openwebtext</a> ( openwebtext )
</p>
<p>
<a href="#readme">#readme</a> ( Readme )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/blob/main/LICENSE">/NVIDIA/Megatron-LM/blob/main/LICENSE</a> ( View license )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/releases">/NVIDIA/Megatron-LM/releases</a> ( Releases 7 )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/releases/tag/v0.1">/NVIDIA/Megatron-LM/releases/tag/v0.1</a> ( BERT mixed precision training Latest <relative-time datetime="2019-03-27T21:06:33Z" class="no-wrap">Mar 27, 2019 )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/releases">/NVIDIA/Megatron-LM/releases</a> ( + 6 releases )
</p>
<p>
<a href="/orgs/NVIDIA/packages?repo_name=Megatron-LM">/orgs/NVIDIA/packages?repo_name=Megatron-LM</a> ( Packages 0 )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/graphs/contributors">/NVIDIA/Megatron-LM/graphs/contributors</a> ( Contributors 13 )
</p>
<p>
<a href="/jaredcasper">/jaredcasper</a> ( )
</p>
<p>
<a href="/borisfom">/borisfom</a> ( )
</p>
<p>
<a href="/ekmb">/ekmb</a> ( )
</p>
<p>
<a href="/mpatwary">/mpatwary</a> ( )
</p>
<p>
<a href="/raulpuric">/raulpuric</a> ( )
</p>
<p>
<a href="/nakosung">/nakosung</a> ( )
</p>
<p>
<a href="/sublee">/sublee</a> ( )
</p>
<p>
<a href="/akhileshgotmare">/akhileshgotmare</a> ( )
</p>
<p>
<a href="/dweekly">/dweekly</a> ( )
</p>
<p>
<a href="/plegresl">/plegresl</a> ( )
</p>
<p>
<a href="/shoeybi">/shoeybi</a> ( )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/graphs/contributors">/NVIDIA/Megatron-LM/graphs/contributors</a> ( + 2 contributors )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/search?l=python">/NVIDIA/Megatron-LM/search?l=python</a> ( Python 84.9% )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/search?l=c%2B%2B">/NVIDIA/Megatron-LM/search?l=c%2B%2B</a> ( C++ 10.6% )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/search?l=cuda">/NVIDIA/Megatron-LM/search?l=cuda</a> ( Cuda 4.1% )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/search?l=tex">/NVIDIA/Megatron-LM/search?l=tex</a> ( TeX 0.2% )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/search?l=c">/NVIDIA/Megatron-LM/search?l=c</a> ( C 0.1% )
</p>
<p>
<a href="/NVIDIA/Megatron-LM/search?l=makefile">/NVIDIA/Megatron-LM/search?l=makefile</a> ( Makefile 0.1% )
</p>
<p>
<a href="https://docs.github.com/en/github/site-policy/github-terms-of-service">https://docs.github.com/en/github/site-policy/github-terms-of-service</a> ( Terms )
</p>
<p>
<a href="https://docs.github.com/en/github/site-policy/github-privacy-statement">https://docs.github.com/en/github/site-policy/github-privacy-statement</a> ( Privacy )
</p>
<p>
<a href="https://github.com/security">https://github.com/security</a> ( Security )
</p>
<p>
<a href="https://www.githubstatus.com/">https://www.githubstatus.com/</a> ( Status )
</p>
<p>
<a href="https://docs.github.com">https://docs.github.com</a> ( Docs )
</p>
<p>
<a href="https://github.com">https://github.com</a> ( )
</p>
<p>
<a href="https://support.github.com">https://support.github.com</a> ( Contact GitHub )
</p>
<p>
<a href="https://github.com/pricing">https://github.com/pricing</a> ( Pricing )
</p>
<p>
<a href="https://docs.github.com">https://docs.github.com</a> ( API )
</p>
<p>
<a href="https://services.github.com">https://services.github.com</a> ( Training )
</p>
<p>
<a href="https://github.blog">https://github.blog</a> ( Blog )
</p>
<p>
<a href="https://github.com/about">https://github.com/about</a> ( About )
</p>
<p>
<a href=""></a> ( )
</p>
<p>
<a href=""></a> ( )
</p>
</body>
</html>
